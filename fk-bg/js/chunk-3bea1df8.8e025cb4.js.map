{"version":3,"sources":["webpack:///./src/hooks/useSearch.js","webpack:///./src/hooks/useSelect.js","webpack:///./src/pages/message/Message.vue","webpack:///./src/pages/message/table.js","webpack:///./src/pages/message/Message.vue?70de","webpack:///./src/pages/message/Message.vue?efd1"],"names":["useSearch","getList","sourceData","data","route","useRoute","departmentList","ref","value","label","handleChange","async","filter","item","department","getDepartment","then","res","map","depName","unshift","onSearch","meta","status","search","filterOption","input","option","toLowerCase","indexOf","useSelect","deleteFn","selectedRowKeys","onSelectChange","console","log","deleteAll","id","result","code","message","info","msg","class","_createElementVNode","style","_createElementBlock","_hoisted_4","_createVNode","_component_a_select","_ctx","$event","show-search","placeholder","options","filter-option","onChange","_hoisted_6","_component_a_input_search","_component_a_button","type","loading","onClick","_hoisted_10","_component_a_table","row-selection","columns","data-source","pagination","rowKey","record","feedbackId","bodyCell","column","key","_hoisted_12","_hoisted_13","_hoisted_14","useTable","router","useRouter","repay","push","path","query","edit","size","pageSize","title","dataIndex","width","isShow","fkList","content","length","substr","isName","anonymity","isPublic","isShown","date","createTime","replace","name","defineComponent","setup","deleteFk","watch","nval","onMounted","undefined","topic","__exports__","render"],"mappings":"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","file":"js/chunk-3bea1df8.8e025cb4.js","sourcesContent":["import { ref } from 'vue';\r\nimport {useRoute } from 'vue-router'\r\nimport {department} from '../api'\r\n\r\nexport default function useSearch(getList,sourceData,data){\r\n  const route = useRoute()\r\n    // 部门数据\r\n    const departmentList = ref([{\r\n        value: 'jack',\r\n        label: 'Jack',\r\n      }, {\r\n        value: 'lucy',\r\n        label: 'Lucy',\r\n      }, {\r\n        value: 'tom',\r\n        label: 'Tom',\r\n      }]);\r\n     // 部门选中\r\n      const handleChange = async value => {\r\n     \r\n        data.value = sourceData.value\r\n        if(value){\r\n          data.value = data.value.filter(item=>{\r\n            return item.department==value\r\n          })\r\n        }\r\n         \r\n      }; \r\n\r\n      const getDepartment = ()=>{\r\n        department('').then(res=>{\r\n          departmentList.value = res.data.map(item=>{\r\n           return {\r\n            label:item.depName,\r\n            value:item.depName\r\n           }\r\n          })\r\n          departmentList.value.unshift({label:'全部',value:''})\r\n        })\r\n      }\r\n      getDepartment()\r\n    // 主题搜索\r\n     const onSearch = (value)=>{\r\n \r\n      getList(route.meta.status,value)\r\n    \r\n     }  \r\n\r\n    let search = ref('')\r\n       //部门过滤\r\n      const filterOption = (input, option) => {\r\n        return option.value.toLowerCase().indexOf(input.toLowerCase()) >= 0;\r\n      };\r\n\r\n      return {\r\n        filterOption,onSearch,handleChange,departmentList,search\r\n      }\r\n}","import { reactive,ref } from 'vue';\r\nimport { deleteFk } from '../api';\r\nimport { message } from 'ant-design-vue';\r\nimport { useRoute } from 'vue-router';\r\n\r\nexport default function useSelect(getList,deleteFn){\r\n        // 多选\r\n         const route =useRoute()\r\n          let selectedRowKeys = ref([])\r\n          \r\n          //选中改变\r\n          const onSelectChange = value => {\r\n            console.log('selectedRowKeys changed: ', value);\r\n            selectedRowKeys.value = value\r\n         \r\n          };\r\n\r\n          const deleteAll = async (id='')=>{\r\n            console.log(id)\r\n            let result\r\n                 if(id){\r\n             result = await deleteFn(id)\r\n         \r\n                 }\r\n                 else{\r\n                  console.log(selectedRowKeys.value)\r\n                   result = await deleteFn(selectedRowKeys.value)\r\n                 }\r\n                 if(result.code==200){\r\n                  message.info('删除成功')\r\n                  getList(route.meta.status)\r\n                 }\r\n                 else{\r\n                  message.info(result.msg||'失败')\r\n                 }\r\n            \r\n          }\r\n    \r\n          \r\n      \r\n          return {\r\n           onSelectChange,selectedRowKeys,deleteAll\r\n          }\r\n\r\n}","<template>\r\n    <div class=\"message_wra\" >\r\n        <div class=\"search\">\r\n            <div class=\"department\"> \r\n                <div class=\"title\">反馈部门：</div>\r\n                <a-select\r\n    v-model:value=\"department\"\r\n    show-search\r\n    placeholder=\"选择部门\"\r\n    style=\"width: 200px\"\r\n    :options=\"departmentList\"\r\n    :filter-option=\"filterOption\"   \r\n    @change=\"handleChange\"\r\n  ></a-select></div>\r\n  <div class=\"topic\">\r\n    <div class=\"title\">主题/内容：</div>\r\n     <a-input-search\r\n      v-model:value=\"search\"\r\n      placeholder=\"查找主题/内容\"\r\n      style=\"width: 300px\"\r\n      @search=\"onSearch\"\r\n    />\r\n  </div>\r\n        </div>\r\n        <div class=\"table\">\r\n          <div style=\"margin-bottom: 16px\" class=\"btn\">\r\n      <a-button type=\"primary\"  :loading=\"loading\" @click=\"deleteAll('')\">\r\n        批量删除\r\n      </a-button>\r\n      <span style=\"margin-left: 8px\">\r\n      \r\n      </span>\r\n    </div>\r\n             <a-table \r\n                :row-selection=\"{ selectedRowKeys: selectedRowKeys, onChange: onSelectChange }\"\r\n             :columns=\"columns\" \r\n             :data-source=\"data\"  \r\n             :pagination=\"pagination\"\r\n             :rowKey=\"record => record.feedbackId\"\r\n          \r\n         \r\n            >\r\n    \r\n\r\n    <template #bodyCell=\"{ column, record }\">\r\n    \r\n    \r\n      <template v-if=\"column.key === 'action'\">\r\n        <div style=\"width:100px\">\r\n          <a @click=\"edit(record)\" v-if=\"$route.meta.status\">编辑</a>\r\n        \r\n          <a v-else @click=\"repay(record)\">回复</a>\r\n        \r\n          <a @click=\"deleteAll([record.feedbackId])\">\r\n            移除\r\n          </a>\r\n        </div>\r\n      </template>\r\n    </template>\r\n  </a-table>\r\n\r\n        </div>\r\n        \r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent, toRefs,ref,onMounted,watch } from 'vue';\r\nimport { useRoute,onBeforeRouteLeave} from 'vue-router'\r\nimport useSelect from '../../hooks/useSelect';\r\nimport useTable from './table'\r\nimport useSearch from '../../hooks/useSearch'\r\nimport { ConsoleSqlOutlined } from '@ant-design/icons-vue';\r\nimport {fkList,deleteFk} from '../../api'\r\nimport { message } from 'ant-design-vue';\r\n\r\nexport default defineComponent({\r\n    setup() {    \r\n\r\n const route = useRoute()\r\n\r\n\r\n//表格和操作\r\n    const {repay,columns,data,getList,pagination,edit,sourceData} =  useTable()\r\n    //多选 批量操作\r\n    const {onSelectChange,selectedRowKeys,deleteAll}  = useSelect(getList,deleteFk)\r\n\r\n   \r\n    //搜索和部门选择\r\n    const {departmentList,handleChange,onSearch,filterOption,search} = useSearch(getList,sourceData,data)\r\n\r\n  watch(()=>route.meta.status,(nval)=>{\r\n         getList(nval)\r\n  })\r\n     onMounted( ()=>{\r\n     getList(route.meta.status)\r\n     })\r\n    \r\n\r\n\r\n \r\n\r\n    return {\r\n      department: ref(undefined),\r\n      filterOption,\r\n      handleChange,\r\n      departmentList,\r\n      onSearch,\r\n      topic:ref(''),\r\n      columns,\r\n      data,\r\n      pagination,\r\n      search,\r\n      edit,\r\n      onSelectChange,\r\n      selectedRowKeys,\r\n      deleteAll,\r\n      \r\n\r\n    \r\n      \r\n      // func\r\n   \r\n      repay\r\n    };\r\n  },\r\n\r\n});\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.message_wra{\r\n    .search{\r\n        display: flex;\r\n        margin-top: 20px;\r\n        margin-left: 20px;\r\n        width: 50vw;\r\n        justify-content:space-between;\r\n\r\n        .department{\r\n            display: flex;\r\n            align-items: center;\r\n        }\r\n\r\n        .topic{\r\n            display: flex;\r\n            align-items: center;\r\n        }\r\n    }\r\n    .table{\r\n      width: 80vw;\r\n      margin: auto;\r\n      height: 80vh;\r\n      overflow: auto;\r\n      .btn{\r\n        display: flex;\r\n        justify-content: flex-end;     }\r\n        // /deep/.ant-table-thead > tr > th{\r\n        //   text-align: justify;\r\n        //   display: -webkit-box;\r\n        //   -webkit-line-clamp: 2;\r\n        //   overflow: hidden;\r\n        //   text-overflow: ellipsis;\r\n        //   -webkit-box-orient: vertical;\r\n        // }\r\n        /deep/.ant-table-tbody > tr > td{\r\n          text-align: justify;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import {useRouter,useRoute} from 'vue-router'\r\nimport {ref} from 'vue'\r\n\r\nimport {fkList} from '../../api'\r\n\r\n\r\nexport default  function useTable(){\r\n    const router = useRouter()\r\n    const route = useRoute()\r\n       //回复\r\n       const repay = (data)=>{\r\n        router.push({path:'/main/detail',query:{id:data.feedbackId,status:0}})\r\n        \r\n      }\r\n      //编辑\r\n      const edit = (data)=>{\r\n        router.push({path:'/main/detail',query:{id:data.feedbackId,status:1}})\r\n      }\r\n      const pagination={\r\n        size:'large',\r\n         pageSize:5\r\n       \r\n    }\r\n      \r\n    // 表格头，没有的表头做过滤\r\n    const columns = [{\r\n        title: '主题',\r\n        dataIndex: 'topic',\r\n        key: 'topic',\r\n       width:100,\r\n      }, {\r\n        title: '内容',\r\n        dataIndex: 'content',\r\n        key: 'content',\r\n        width:200\r\n      }, {\r\n        title: '问题类型',\r\n        key: 'type',\r\n        width:100,\r\n        dataIndex: 'type',\r\n      }, \r\n      {\r\n        title: '反馈部门',\r\n        key: 'department',\r\n        dataIndex: 'department',\r\n        width:100,\r\n        isShow:false\r\n      },\r\n      {\r\n        title: '是否匿名',\r\n        key: 'isName',\r\n        dataIndex: 'isName',\r\n        width:100,\r\n      },\r\n      {\r\n        title: '是否公开',\r\n        key: 'isPublic',\r\n        dataIndex: 'isPublic',\r\n        width:100,\r\n      },\r\n      {\r\n        title: '反馈人',\r\n        key: 'name',\r\n        dataIndex: 'name',\r\n        width:100,\r\n      },\r\n      {\r\n        title: '反馈时间',\r\n        key: 'date',\r\n        dataIndex: 'date',\r\n        width:150,\r\n      },\r\n      {\r\n        title: '操作',\r\n        key: 'action',\r\n        width:100,\r\n      }];\r\n      //表格数据\r\n      const data =ref( [\r\n       \r\n       \r\n      ]);\r\n      let sourceData = ref([])\r\n      const getList = (status,key='')=>{\r\n\r\n      fkList(status,key).then(res=>{\r\n        data.value = res.data.map(item=>{\r\n     \r\n          if(item.content.length>15){\r\n           \r\n            return {\r\n              ...item,\r\n              content:item.content.substr(0,15)+'...',\r\n              isName:item.anonymity?'是':'否',\r\n              isPublic:item.isShown?'是':'否 ',\r\n              date:item.createTime.replace('T',' ').replace('Z',''),\r\n              name:item.anonymity?'匿名':item.name\r\n            }\r\n          }\r\n          else{\r\n            return {\r\n              ...item,\r\n              isName:item.anonymity?'是':'否',\r\n              isPublic:item.isShown?'是':'否 ',\r\n              date:item.createTime.replace('T',' ').replace('Z',''),\r\n              name:item.anonymity?'匿名':item.name\r\n            }\r\n          }\r\n\r\n         \r\n        })\r\n        \r\n        sourceData.value = data.value\r\n        \r\n      })\r\n\r\n\r\n        \r\n     }\r\n     \r\n    \r\n      return {\r\n        data,columns,repay,getList,pagination,edit,sourceData\r\n      }\r\n}","import { render } from \"./Message.vue?vue&type=template&id=a9ae8064&scoped=true\"\nimport script from \"./Message.vue?vue&type=script&lang=js\"\nexport * from \"./Message.vue?vue&type=script&lang=js\"\n\nimport \"./Message.vue?vue&type=style&index=0&id=a9ae8064&lang=less&scoped=true\"\n\nimport exportComponent from \"C:\\\\前端\\\\fk-bg\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a9ae8064\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Message.vue?vue&type=style&index=0&id=a9ae8064&lang=less&scoped=true\""],"sourceRoot":""}